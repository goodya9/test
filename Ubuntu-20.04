FROM anggit86/docker:cirrus
LABEL maintainer="NFS86 <jarbull86@gmail.com>"

ENV DEBIAN_FRONTEND noninteractive
ENV LANG=C.UTF-8
ENV LC_ALL=C
ENV USE_CCACHE=1
ENV ANDROID_JACK_VM_ARGS="-Dfile.encoding=UTF-8 -XX:+TieredCompilation -Xmx120G"
ENV JAVA_OPTS=" -Xmx120G "
ENV USER=cirrus
ENV CCACHE_EXEC=/usr/bin/ccache
ENV HOSTNAME=cirrus-ci.org
ENV JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64
WORKDIR /home/cirrus-ci-build

RUN apt-get -yqq update && apt-get -yqq upgrade

RUN mkdir -p $WORKDIR/ProjectKasumi \
      && cd $WORKDIR/ProjectKasumi \
      && repo init --depth=1 --no-repo-verify -u git://github.com/ProjectKasumi/android.git -b kasumi-v1 -g default,,-mips,-darwin,-notdefault \
      && repo sync -c --no-clone-bundle --no-tags --optimized-fetch --force-sync -j4

VOLUME ["/home/cirrus-ci-build/rom", "/home/cirrus-ci-build/ccache"]
ENTRYPOINT ["/bin/bash"]